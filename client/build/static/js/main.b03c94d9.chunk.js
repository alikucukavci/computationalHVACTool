(window.webpackJsonpclient=window.webpackJsonpclient||[]).push([[0],{58:function(e,t,a){e.exports=a(94)},63:function(e,t,a){},65:function(e,t,a){},94:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(25),s=a.n(o),i=(a(63),a(12)),l=(a(64),a(65),a(6)),c=a(97),m=a(99),u=a(96),p=a(8),d=a.n(p);function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var f=function(e){var t=Object(n.useState)({username:"",password:"",message:""}),a=Object(i.a)(t,2),o=a[0],s=a[1],p=function(e){var t=e.target,a=t.name,n=t.value;s(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(a,!0).forEach((function(t){Object(l.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},o,Object(l.a)({},a,n)))};return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Signup"),r.a.createElement(c.a,{onSubmit:function(t){t.preventDefault(),function(e,t){return d.a.post("/api/auth/signup",{username:e,password:t}).then((function(e){return e.data})).catch((function(e){return e.response.data}))}(o.username,o.password).then((function(t){t.message?s({message:t.message,username:"",password:""}):(e.setUser(t),e.history.push("/projects"))}))}},r.a.createElement(c.a.Group,null,r.a.createElement(c.a.Label,{htmlFor:"username"},"Username: "),r.a.createElement(c.a.Control,{type:"text",name:"username",value:o.username,onChange:p,id:"username"})),r.a.createElement(c.a.Group,null,r.a.createElement(c.a.Label,{htmlFor:"password"},"Password: "),r.a.createElement(c.a.Control,{type:"password",name:"password",value:o.password,onChange:p,id:"password"})),o.message&&r.a.createElement(m.a,{variant:"danger"},o.message),r.a.createElement(u.a,{type:"submit"},"Signup")))};function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var E=function(e){var t=Object(n.useState)({username:"",password:"",message:""}),a=Object(i.a)(t,2),o=a[0],s=a[1],p=function(e){var t=e.target,a=t.name,n=t.value;s(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(a,!0).forEach((function(t){Object(l.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},o,Object(l.a)({},a,n)))};return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Login"),r.a.createElement(c.a,{onSubmit:function(t){t.preventDefault(),function(e,t){return d.a.post("/api/auth/login",{username:e,password:t}).then((function(e){return e.data})).catch((function(e){return e.response.data}))}(o.username,o.password).then((function(t){t.message?s({message:t.message,username:"",password:""}):(e.setUser(t),e.history.push("/projects"))}))}},r.a.createElement(c.a.Group,null,r.a.createElement(c.a.Label,{htmlFor:"username"},"Username: "),r.a.createElement(c.a.Control,{type:"text",name:"username",value:o.username,onChange:p,id:"username"})),r.a.createElement(c.a.Group,null,r.a.createElement(c.a.Label,{htmlFor:"password"},"Password: "),r.a.createElement(c.a.Control,{type:"password",name:"password",value:o.password,onChange:p,id:"password"})),o.message&&r.a.createElement(m.a,{variant:"danger"},o.message),r.a.createElement(u.a,{type:"submit"},"Login")))},g=a(16),j=a(14),w=a(98),v=function(e){d.a.delete("/api/auth/logout").then((function(e){return e.data})).catch((function(e){return e.response.data})).then((function(){e.setUser(null)}))},O=function(e){return r.a.createElement(w.a,{className:"nav justify-content-end fixed-top",bg:"primary"},e.user&&r.a.createElement(w.a.Brand,null,"Welcome, ",e.user.username),r.a.createElement(w.a.Brand,null,r.a.createElement(j.b,{to:"/"},"Home")),e.user?r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a.Brand,null,r.a.createElement(j.b,{to:"/projects"},"Projects")),r.a.createElement(w.a.Brand,null,r.a.createElement(j.b,{to:"/",onClick:function(){return v(e)}},"Logout"))):r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a.Brand,null,r.a.createElement(j.b,{to:"/signup"},"Signup")),r.a.createElement(w.a.Brand,null,r.a.createElement(j.b,{to:"/login"},"Login"))))},y=function(e){return r.a.createElement("div",{className:"col-2 projectBar"},r.a.createElement("h5",null,"Projects"),e.projects.map((function(t){return r.a.createElement("div",{onClick:function(){e.setOneProject(t),e.setDisplay("ThreeJS")}},t.title)})),r.a.createElement("button",{onClick:function(){return e.setDisplay("Form")},className:"btn btn-dark"},"New"))},N=a(39),A=a.n(N);function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var S=function(e){(new FileReader).onload=function(t){e.setFile(JSON.parse(t.target.result))};var t=function(t){var a=t.target,n=a.name,r=a.value;e.setcreateNewProject(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(a,!0).forEach((function(t){Object(l.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e.createNewProject,Object(l.a)({},n,r)))};return r.a.createElement("div",null,r.a.createElement("h2",null,"Add task: "),r.a.createElement(c.a,{onSubmit:function(t){t.preventDefault(),d.a.post("/api/projects",{title:e.createNewProject.title,description:e.createNewProject.description}).then((function(t){console.log(t.data),e.setDisplay("newProject")})).catch((function(e){console.log(e)})),d.a.get("/api/projects").then((function(t){e.setProjects(t.data),console.log(t.data)}))}},r.a.createElement(c.a.Group,null,r.a.createElement(c.a.Label,null,"Title:"),r.a.createElement(c.a.Control,{type:"text",name:"title",value:e.createNewProject.title,onChange:t})),r.a.createElement(c.a.Group,null,r.a.createElement(c.a.Label,null,"Description:"),r.a.createElement(c.a.Control,{type:"text",name:"description",value:e.description,onChange:t})),r.a.createElement(u.a,{type:"submit"},"Add")))},F=function(e){var t=new FileReader;return t.onload=function(t){var a=JSON.parse(t.target.result);a.rooms=a.rooms.map((function(e,t){return e.id=t,e})),e.setOneProject({}),e.setFile(a),d.a.put("/api/projects/".concat(e.project._id),{file:a}),e.setDisplay("ThreeJS")},r.a.createElement("div",{className:"upload-page"},r.a.createElement(c.a.Group,null,r.a.createElement("div",{className:"files"},r.a.createElement(A.a,{className:"files-dropzone",onChange:function(e){t.readAsText(e[0])},onError:function(e){return console.log(e)},accepts:[".json"],multiple:!0,maxFiles:3,maxFileSize:1e7,minFileSize:0,clickable:!0},"Drop files here or click to upload"))),"    ")},C=a(19),D=a(30),x=a(21),U=a(20),k=a(22),L=a(3),H=a(32),I=a.n(H),M=a(33),z=function(e){function t(){var e,a;Object(C.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(x.a)(this,(e=Object(U.a)(t)).call.apply(e,[this].concat(r)))).state={popup:!1,id:"",roomName:"",roomNumber:0,roomVolume:0,roomArea:0,roomAHU:0,roomAirflow:0,roomID:""},a.closePopup=function(e){a.setState({popup:!a.state.popup})},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(l.a)({},n,r))},a.start=function(){a.frameId||(a.frameId=requestAnimationFrame(a.animate))},a.stop=function(){cancelAnimationFrame(a.frameId)},a.animate=function(){a.renderScene(),a.frameId=window.requestAnimationFrame(a.animate)},a.renderScene=function(){a.renderer.render(a.scene,a.camera)},a.handleSubmit=function(e){e.preventDefault();var t=a.state,n=t.roomAHU,r=t.roomAirflow,o=t.roomID;d.a.put("/api/projects/".concat(a.props.project._id),{roomAHU:n,roomAirflow:r,roomID:o}).then((function(e){console.log(e.data),a.props.setOneProject(e.data);var t=a.props.projects.map((function(t){return t._id===e.data._id?e.data:t}));a.props.setProjects(t)})),console.log(a.props.project._id,"threeJS react working")},a}return Object(k.a)(t,e),Object(D.a)(t,[{key:"componentDidUpdate",value:function(){var e=this;console.log(this.scene),this.props.jsonFile.rooms.forEach((function(t){var a=e.scene.children.find((function(e){return e.roomID===t.id}));console.log(a),a.AHU=t.roomAHU,a.Airflow=t.roomAirflow}))}},{key:"componentDidMount",value:function(){var e=this;this.scene=new L.Scene,this.camera=new L.PerspectiveCamera(20,window.innerWidth/window.innerHeight,20,1e3),this.camera.position.z=100,this.renderer=new L.WebGLRenderer({antialias:!0}),this.renderer.setClearColor("#000000"),this.renderer.setSize(window.innerWidth,window.innerHeight),this.mount.appendChild(this.renderer.domElement),this.controls=new I.a(this.camera,this.renderer.domElement),this.interaction=new M.a(this.renderer,this.scene,this.camera);for(var t=[],a=[],n=0;n<this.props.jsonFile.rooms.length;n++){var r=new L.BoxGeometry(this.props.jsonFile.rooms[n].size.x,this.props.jsonFile.rooms[n].size.y,this.props.jsonFile.rooms[n].size.z),o=new L.MeshLambertMaterial({color:"red"}),s=new L.LineSegments(new L.EdgesGeometry(r),new L.LineBasicMaterial({color:"#000000"}));t.push(new L.Mesh(r,o)),a.push(s)}for(var i=0;i<t.length;i++)t[i].position.set(this.props.jsonFile.rooms[i].position.x,this.props.jsonFile.rooms[i].position.y,this.props.jsonFile.rooms[i].position.z),a[i].position.set(this.props.jsonFile.rooms[i].position.x,this.props.jsonFile.rooms[i].position.y,this.props.jsonFile.rooms[i].position.z),t[i].Name=this.props.jsonFile.rooms[i].roomName,t[i].Number=this.props.jsonFile.rooms[i].roomNumber,t[i].Volume=this.props.jsonFile.rooms[i].roomVolume,t[i].Area=this.props.jsonFile.rooms[i].roomArea,t[i].AHU=this.props.jsonFile.rooms[i].roomAHU,t[i].Airflow=this.props.jsonFile.rooms[i].roomAirflow,t[i].roomID=this.props.jsonFile.rooms[i].id,t[i].cursor="pointer",t[i].on("click",(function(t){e.setState({popup:!e.state.popup,id:t.target.uuid,roomID:t.target.roomID,roomName:t.target.Name,roomNumber:t.target.Number,roomVolume:t.target.Volume,roomArea:t.target.Area,roomAHU:t.target.AHU,roomAirflow:t.target.Airflow},(function(){return console.log("state update:",e.state)}))})),this.scene.add(t[i]),this.scene.add(a[i]),console.log(t[i]);this.popup=!1,this.lightAmbient=new L.AmbientLight(16777215,.5),this.scene.add(this.lightAmbient),this.sunLight=new L.DirectionalLight(16777215,2,1e3),this.scene.add(this.sunLight),this.start()}},{key:"componentWillUnmount",value:function(){this.stop(),this.mount.removeChild(this.renderer.domElement)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("form",{className:"form-roomSubmit",onSubmit:this.handleSubmit},this.state.popup&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"popup",id:"exampleModalScrollable",tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalScrollableTitle","aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog modal-dialog-centered",role:"document"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"exampleModalCenterTitle"},this.state.roomName," ",this.state.roomNumber),r.a.createElement("button",{type:"button",onClick:function(){return e.closePopup()},className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("div",{className:"modal-body"},r.a.createElement("div",null,"Volume: ",this.state.roomVolume," m3"),r.a.createElement("div",null,"Area: ",this.state.roomArea," m3"),r.a.createElement("div",{className:"popup-input"},r.a.createElement("div",{className:"popup-changeableInput"}," AHU-VE ",this.state.roomAHU),r.a.createElement("input",{type:"number",name:"roomAHU",value:0===this.state.roomAHU?"":this.state.roomAHU,onChange:this.handleChange})),r.a.createElement("div",{className:"popup-input"},r.a.createElement("div",{className:"popup-changeableInput"},"Airflow ",this.state.roomAirflow," m3/h ")," ",r.a.createElement("input",{type:"number",name:"roomAirflow",value:0===this.state.roomAirflow?"":this.state.roomAirflow,onChange:this.handleChange}))),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Save changes"))))),r.a.createElement("div",{className:"transparent-background"})),r.a.createElement("div",{style:{width:"400px",height:"400px"},ref:function(t){e.mount=t}})))}}]),t}(n.Component),B=function(){var e,t=Object(n.useState)("None"),a=Object(i.a)(t,2),o=a[0],s=a[1],c=Object(n.useState)({}),m=Object(i.a)(c,2),u=m[0],p=m[1],h=Object(n.useState)([]),f=Object(i.a)(h,2),b=f[0],E=f[1],g=Object(n.useState)({title:"",description:""}),j=Object(i.a)(g,2),w=j[0],v=j[1],O=Object(n.useState)({}),N=Object(i.a)(O,2),A=N[0],P=N[1];return Object(n.useEffect)((function(){d.a.get("/api/projects").then((function(e){E(e.data),console.log(e.data)})),s("None")}),[]),console.log("Projects component render"),"None"===o?r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement(y,{projects:b,setDisplay:s,setOneProject:p}),r.a.createElement("div",{className:"col-10 projectScreen"}))):"Form"===o?r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement(y,{projects:b,setDisplay:s,setOneProject:p}),r.a.createElement("div",{className:"col-10 projectScreen"},r.a.createElement(S,(e={setDisplay:s,createNewProject:w,setcreateNewProject:v},Object(l.a)(e,"setDisplay",s),Object(l.a)(e,"setProjects",E),Object(l.a)(e,"projects",b),Object(l.a)(e,"jsonFile",A),Object(l.a)(e,"setFile",P),e))))):"oneProject"===o?r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement(y,{projects:b,setDisplay:s,setOneProject:p}),r.a.createElement("div",{className:"col-10 projectScreen"},r.a.createElement("div",null," ",r.a.createElement("h1",null," ",u.title))))):"newProject"===o?r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement(y,{projects:b,setDisplay:s,setOneProject:p}),r.a.createElement("div",{className:"col-10 projectScreen"},r.a.createElement(F,{setOneProject:p,project:b[b.length-1],jsonFile:A,setFile:P,setDisplay:s})))):"ThreeJS"===o?(console.log(u),r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement(y,{projects:b,setDisplay:s,setOneProject:p}),r.a.createElement("div",{className:"col-10 projectScreen"},r.a.createElement(z,{projects:b,setOneProject:p,project:u,jsonFile:u.file?u.file:A,setProjects:E}))))):void 0},G=function(e){function t(){var e,a;Object(C.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(x.a)(this,(e=Object(U.a)(t)).call.apply(e,[this].concat(r)))).state={popup:!1,id:"",roomName:"",roomNumber:0,roomVolume:0,roomArea:0,roomAHU:0,roomAirflow:0},a.closePopup=function(e){a.setState({popup:!a.state.popup})},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(l.a)({},n,r))},a.start=function(){a.frameId||(a.frameId=requestAnimationFrame(a.animate))},a.stop=function(){cancelAnimationFrame(a.frameId)},a.animate=function(){a.renderScene(),a.frameId=window.requestAnimationFrame(a.animate)},a.renderScene=function(){a.renderer.render(a.scene,a.camera)},a}return Object(k.a)(t,e),Object(D.a)(t,[{key:"componentDidMount",value:function(){this.scene=new L.Scene,this.camera=new L.PerspectiveCamera(20,window.innerWidth/window.innerHeight,20,1e3),this.camera.position.z=100,this.renderer=new L.WebGLRenderer({antialias:!0}),this.renderer.setClearColor("#000000"),this.renderer.setSize(window.innerWidth,window.innerHeight),this.mount.appendChild(this.renderer.domElement),this.controls=new I.a(this.camera,this.renderer.domElement),this.interaction=new M.a(this.renderer,this.scene,this.camera);var e=new L.BoxGeometry(3,3,3),t=new L.MeshLambertMaterial({color:"#0xF3FFE2"}),a=new L.LineSegments(new L.EdgesGeometry(e),new L.LineBasicMaterial({color:"#000000"})),n=new L.Mesh(e,t);this.scene.add(n),this.scene.add(a),n.position.set(3,3,3),a.position.set(3,3,3),this.popup=!1,this.lightAmbient=new L.AmbientLight(16777215,.5),this.scene.add(this.lightAmbient),this.sunLight=new L.DirectionalLight(16777215,2,1e3),this.scene.add(this.sunLight),this.start()}},{key:"componentWillUnmount",value:function(){this.stop(),this.mount.removeChild(this.renderer.domElement)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,this.state.popup&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"popup",id:"exampleModalScrollable",tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalScrollableTitle","aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog modal-dialog-centered",role:"document"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"exampleModalCenterTitle"},this.state.roomName," ",this.state.roomNumber),r.a.createElement("button",{type:"button",onClick:function(){return e.closePopup()},className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("div",{className:"modal-body"},r.a.createElement("div",null,"Volume: ",this.state.roomVolume," m3"),r.a.createElement("div",null,"Area: ",this.state.roomArea," m3"),r.a.createElement("div",null," ",r.a.createElement("div",null," AHU-VE ",this.state.roomAHU)," ",r.a.createElement("input",{type:"number",name:"roomAHU",value:0===this.state.roomAHU?"":this.state.roomAHU,onChange:this.handleChange})," "),r.a.createElement("div",null,r.a.createElement("div",null,"Airflow ",this.state.roomAirflow," ")," ",r.a.createElement("input",{type:"number",name:"roomAirflow",value:0===this.state.roomAirflow?"":this.state.roomAirflow,onChange:this.handleChange})," ")),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-primary"},"Save changes"))))),r.a.createElement("div",{className:"transparent-background"})),r.a.createElement("div",{style:{width:"400px",height:"400px"},ref:function(t){e.mount=t}}))}}]),t}(n.Component),V=function(e){var t=Object(n.useState)(e.user),a=Object(i.a)(t,2),o=a[0],s=a[1];return console.log(e.user),r.a.createElement("div",{className:"App"},r.a.createElement(O,{user:o,setUser:s}),r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/",component:G}),r.a.createElement(g.b,{exact:!0,path:"/signup",component:function(e){return r.a.createElement(f,Object.assign({setUser:s},e))}}),r.a.createElement(g.b,{exact:!0,path:"/login",component:function(e){return r.a.createElement(E,Object.assign({setUser:s},e))}}),r.a.createElement(g.b,{exact:!0,path:"/projects",component:function(e){return o?r.a.createElement(B,e):r.a.createElement(g.a,{to:"/"})}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));d.a.get("/api/auth/loggedin").then((function(e){var t=e.data;console.log(t),s.a.render(r.a.createElement(j.a,null,r.a.createElement(V,{user:t})),document.getElementById("root"))})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[58,1,2]]]);
//# sourceMappingURL=main.b03c94d9.chunk.js.map